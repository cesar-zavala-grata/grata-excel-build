!function(){var t={64583:function(t,e,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
t.exports=function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}var o=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,i=void 0,c=void 0,s=function(t,e){_[r]=t,_[r+1]=e,2===(r+=2)&&(c?c(b):A())};function a(t){c=t}function u(t){s=t}var l="undefined"!=typeof window?window:void 0,f=l||{},h=f.MutationObserver||f.WebKitMutationObserver,d="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),v="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){return function(){return process.nextTick(b)}}function y(){return void 0!==i?function(){i(b)}:w()}function m(){var t=0,e=new h(b),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function g(){var t=new MessageChannel;return t.port1.onmessage=b,function(){return t.port2.postMessage(0)}}function w(){var t=setTimeout;return function(){return t(b,1)}}var _=new Array(1e3);function b(){for(var t=0;t<r;t+=2)(0,_[t])(_[t+1]),_[t]=void 0,_[t+1]=void 0;r=0}function O(){try{var t=Function("return this")().require("vertx");return i=t.runOnLoop||t.runOnContext,y()}catch(t){return w()}}var A=void 0;function x(t,e){var n=this,o=new this.constructor(I);void 0===o[T]&&z(o);var r=n._state;if(r){var i=arguments[r-1];s(function(){return K(r,o,i,n._result)})}else Y(n,o,t,e);return o}function S(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(I);return L(n,t),n}A=d?p():h?m():v?g():void 0===l?O():w();var T=Math.random().toString(36).substring(2);function I(){}var E=void 0,k=1,C=2;function j(){return new TypeError("You cannot resolve a promise with itself")}function D(){return new TypeError("A promises callback cannot return that same promise.")}function M(t,e,n,o){try{t.call(e,n,o)}catch(t){return t}}function R(t,e,n){s(function(t){var o=!1,r=M(n,e,function(n){o||(o=!0,e!==n?L(t,n):P(t,n))},function(e){o||(o=!0,W(t,e))},"Settle: "+(t._label||" unknown promise"));!o&&r&&(o=!0,W(t,r))},t)}function F(t,e){e._state===k?P(t,e._result):e._state===C?W(t,e._result):Y(e,void 0,function(e){return L(t,e)},function(e){return W(t,e)})}function N(t,n,o){n.constructor===t.constructor&&o===x&&n.constructor.resolve===S?F(t,n):void 0===o?P(t,n):e(o)?R(t,n,o):P(t,n)}function L(e,n){if(e===n)W(e,j());else if(t(n)){var o=void 0;try{o=n.then}catch(t){return void W(e,t)}N(e,n,o)}else P(e,n)}function B(t){t._onerror&&t._onerror(t._result),G(t)}function P(t,e){t._state===E&&(t._result=e,t._state=k,0!==t._subscribers.length&&s(G,t))}function W(t,e){t._state===E&&(t._state=C,t._result=e,s(B,t))}function Y(t,e,n,o){var r=t._subscribers,i=r.length;t._onerror=null,r[i]=e,r[i+k]=n,r[i+C]=o,0===i&&t._state&&s(G,t)}function G(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var o=void 0,r=void 0,i=t._result,c=0;c<e.length;c+=3)o=e[c],r=e[c+n],o?K(n,o,r,i):r(i);t._subscribers.length=0}}function K(t,n,o,r){var i=e(o),c=void 0,s=void 0,a=!0;if(i){try{c=o(r)}catch(t){a=!1,s=t}if(n===c)return void W(n,D())}else c=r;n._state!==E||(i&&a?L(n,c):!1===a?W(n,s):t===k?P(n,c):t===C&&W(n,c))}function H(t,e){try{e(function(e){L(t,e)},function(e){W(t,e)})}catch(e){W(t,e)}}var J=0;function q(){return J++}function z(t){t[T]=J++,t._state=void 0,t._result=void 0,t._subscribers=[]}function U(){return new Error("Array Methods must be provided an Array")}var X=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(I),this.promise[T]||z(this.promise),o(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&P(this.promise,this._result))):W(this.promise,U())}return t.prototype._enumerate=function(t){for(var e=0;this._state===E&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,o=n.resolve;if(o===S){var r=void 0,i=void 0,c=!1;try{r=t.then}catch(t){c=!0,i=t}if(r===x&&t._state!==E)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(n===et){var s=new n(I);c?W(s,i):N(s,t,r),this._willSettleAt(s,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(o(t),e)},t.prototype._settledAt=function(t,e,n){var o=this.promise;o._state===E&&(this._remaining--,t===C?W(o,n):this._result[e]=n),0===this._remaining&&P(o,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;Y(t,void 0,function(t){return n._settledAt(k,e,t)},function(t){return n._settledAt(C,e,t)})},t}();function Q(t){return new X(this,t).promise}function V(t){var e=this;return o(t)?new e(function(n,o){for(var r=t.length,i=0;i<r;i++)e.resolve(t[i]).then(n,o)}):new e(function(t,e){return e(new TypeError("You must pass an array to race."))})}function Z(t){var e=new this(I);return W(e,t),e}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function tt(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var et=function(){function t(e){this[T]=q(),this._result=this._state=void 0,this._subscribers=[],I!==e&&("function"!=typeof e&&$(),this instanceof t?H(this,e):tt())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var n=this,o=n.constructor;return e(t)?n.then(function(e){return o.resolve(t()).then(function(){return e})},function(e){return o.resolve(t()).then(function(){throw e})}):n.then(t,t)},t}();function nt(){var t=void 0;if(void 0!==n.g)t=n.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var o=null;try{o=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===o&&!e.cast)return}t.Promise=et}return et.prototype.then=x,et.all=Q,et.race=V,et.resolve=S,et.reject=Z,et._setScheduler=a,et._setAsap=u,et._asap=s,et.polyfill=nt,et.Promise=et,et}()}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){"use strict";var t,e,o,r="https://cesar-zavala-grata.github.io/grata-excel-build/dialogs/auth.html",i="https://search-beta.grata.com",c="https://help.grata.com";!function(t){t.STAFF="STAFF",t.ADMIN="ADMIN",t.STANDARD="STANDARD"}(t||(t={})),function(t){t.TRIAL="TRIAL"}(e||(e={})),function(t){t.IN_TRIAL="In Trial",t.CANCELLING="Cancelling",t.LEGACY="Legacy",t.COMPLIMENTARY="Complimentary",t.TRIAL_EXPIRED="Trial Expired",t.NONE=""}(o||(o={}));var s=function(){var t,e,n=null!==(e=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.partitionKey)&&void 0!==e?e:"default",o="".concat(n,"-auth-token");return localStorage.getItem(o)},a=n(64583).Promise,u=function(t,e,n,o){return new(n||(n=a))(function(r,i){function c(t){try{a(o.next(t))}catch(t){i(t)}}function s(t){try{a(o.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,s)}a((o=o.apply(t,e||[])).next())})},l=function(t,e){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},c=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return c.next=s(0),c.throw=s(1),c.return=s(2),"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,s[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};function f(t){t.completed()}function h(t){return u(this,void 0,void 0,function(){var e,n,o=this;return l(this,function(i){return e="".concat(r,"?v=").concat(Date.now(),"&action=logout"),Office&&(null===(n=Office.context)||void 0===n?void 0:n.ui)?s()?(Office.context.ui.displayDialogAsync(e,{height:60,width:40,displayInIframe:!1,promptBeforeOpen:!1},function(e){if(e.status===Office.AsyncResultStatus.Failed)console.error("Failed to open logout dialog.");else{var n=e.value;n.addEventHandler(Office.EventType.DialogMessageReceived,function(t){return u(o,void 0,void 0,function(){var e,o;return l(this,function(r){return e=JSON.parse(t.message),function(){var t,e=null!==(t=Office.context.partitionKey)&&void 0!==t?t:"default";localStorage.removeItem("".concat(e,"-user-data")),localStorage.removeItem("".concat(e,"-auth-token")),Object.keys(localStorage).forEach(function(t){(t.startsWith("ld:")||t.startsWith("@@auth0spajs@@"))&&localStorage.removeItem(t)})}(),"logout-success"===e.type&&((o=new BroadcastChannel("grata-auth-channel")).postMessage({type:"auth-changed",action:"logout",timestamp:Date.now()}),o.close(),n.close()),[2]})})})}t.completed()}),t.completed(),[2]):(t.completed(),[2]):(console.error("Office context not available"),t.completed(),[2])})})}function d(t){return u(this,void 0,void 0,function(){var e,n,o=this;return l(this,function(i){return e="".concat(r,"?v=").concat(Date.now(),"&action=login"),Office&&(null===(n=Office.context)||void 0===n?void 0:n.ui)?s()?(t.completed(),[2]):(Office.context.ui.displayDialogAsync(e,{height:60,width:40,displayInIframe:!1,promptBeforeOpen:!1},function(e){if(e.status===Office.AsyncResultStatus.Failed)return console.error("Failed to open login dialog."),void t.completed();var n=e.value;n.addEventHandler(Office.EventType.DialogMessageReceived,function(e){return u(o,void 0,void 0,function(){var o,r,i;return l(this,function(c){switch(c.label){case 0:return c.trys.push([0,4,,5]),"auth-success"!==(o=JSON.parse(e.message)).type?[3,2]:(function(t){var e,n,o=null!==(n=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.partitionKey)&&void 0!==n?n:"default";localStorage.setItem("".concat(o,"-auth-token"),t)}(o.token),[4,new a(function(t){return setTimeout(t,200)})]);case 1:return c.sent(),(r=new BroadcastChannel("grata-auth-channel")).postMessage({type:"auth-changed",action:"login",timestamp:Date.now()}),r.close(),n.close(),t.completed(),[3,3];case 2:"auth-error"===o.type&&(console.error(o.error),t.completed()),c.label=3;case 3:return[3,5];case 4:return i=c.sent(),console.error("Invalid message received from dialog.",i),t.completed(),[3,5];case 5:return[2]}})})})}),t.completed(),[2]):(console.error("Office context not available"),t.completed(),[2])})})}function v(t){return u(this,void 0,void 0,function(){var e,n;return l(this,function(o){return(null===(n=null===(e=Office.context)||void 0===e?void 0:e.ui)||void 0===n?void 0:n.openBrowserWindow)?Office.context.ui.openBrowserWindow(c):window.open(c,"_blank"),t.completed(),[2]})})}function p(t){return u(this,void 0,void 0,function(){var e,n;return l(this,function(o){return(null===(n=null===(e=Office.context)||void 0===e?void 0:e.ui)||void 0===n?void 0:n.openBrowserWindow)?Office.context.ui.openBrowserWindow(i):window.open(i,"_blank"),t.completed(),[2]})})}function y(t){return u(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,OfficeRuntime.storage.setItem("open-route","/credits")];case 1:return e.sent(),[4,Office.addin.showAsTaskpane()];case 2:return e.sent(),t.completed(),[2]}})})}function m(t){return u(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,OfficeRuntime.storage.setItem("open-route","/home")];case 1:return e.sent(),[4,Office.addin.showAsTaskpane()];case 2:return e.sent(),t.completed(),[2]}})})}Office.onReady(function(){return u(void 0,void 0,void 0,function(){return l(this,function(t){return Office.actions.associate("command",f),Office.actions.associate("onLogoutButtonClick",h),Office.actions.associate("onLoginButtonClick",d),Office.actions.associate("openHelp",v),Office.actions.associate("openGrata",p),Office.actions.associate("showCredits",y),Office.actions.associate("showFormulaBuilder",m),[2]})})}).then(null)}()}();