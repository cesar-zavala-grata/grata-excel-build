!function(){var t={64583:function(t,e,n){t.exports=function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,a=void 0,u=function(t,e){I[o]=t,I[o+1]=e,2===(o+=2)&&(a?a(A):M())};function s(t){a=t}function c(t){u=t}var l="undefined"!=typeof window?window:void 0,d=l||{},f=d.MutationObserver||d.WebKitMutationObserver,_="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),E="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function T(){return function(){return process.nextTick(A)}}function v(){return void 0!==i?function(){i(A)}:R()}function h(){var t=0,e=new f(A),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function p(){var t=new MessageChannel;return t.port1.onmessage=A,function(){return t.port2.postMessage(0)}}function R(){var t=setTimeout;return function(){return t(A,1)}}var I=new Array(1e3);function A(){for(var t=0;t<o;t+=2)(0,I[t])(I[t+1]),I[t]=void 0,I[t+1]=void 0;o=0}function b(){try{var t=Function("return this")().require("vertx");return i=t.runOnLoop||t.runOnContext,v()}catch(t){return R()}}var M=void 0;function N(t,e){var n=this,r=new this.constructor(w);void 0===r[S]&&q(r);var o=n._state;if(o){var i=arguments[o-1];u(function(){return H(o,r,i,n._result)})}else U(n,r,t,e);return r}function y(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(w);return P(n,t),n}M=_?T():f?h():E?p():void 0===l?b():R();var S=Math.random().toString(36).substring(2);function w(){}var m=void 0,L=1,O=2;function D(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function x(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function G(t,e,n){u(function(t){var r=!1,o=x(n,e,function(n){r||(r=!0,e!==n?P(t,n):F(t,n))},function(e){r||(r=!0,C(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,C(t,o))},t)}function B(t,e){e._state===L?F(t,e._result):e._state===O?C(t,e._result):U(e,void 0,function(e){return P(t,e)},function(e){return C(t,e)})}function V(t,n,r){n.constructor===t.constructor&&r===N&&n.constructor.resolve===y?B(t,n):void 0===r?F(t,n):e(r)?G(t,n,r):F(t,n)}function P(e,n){if(e===n)C(e,D());else if(t(n)){var r=void 0;try{r=n.then}catch(t){return void C(e,t)}V(e,n,r)}else F(e,n)}function Y(t){t._onerror&&t._onerror(t._result),j(t)}function F(t,e){t._state===m&&(t._result=e,t._state=L,0!==t._subscribers.length&&u(j,t))}function C(t,e){t._state===m&&(t._state=O,t._result=e,u(Y,t))}function U(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+L]=n,o[i+O]=r,0===i&&t._state&&u(j,t)}function j(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,a=0;a<e.length;a+=3)r=e[a],o=e[a+n],r?H(n,r,o,i):o(i);t._subscribers.length=0}}function H(t,n,r,o){var i=e(r),a=void 0,u=void 0,s=!0;if(i){try{a=r(o)}catch(t){s=!1,u=t}if(n===a)return void C(n,g())}else a=o;n._state!==m||(i&&s?P(n,a):!1===s?C(n,u):t===L?F(n,a):t===O&&C(n,a))}function Q(t,e){try{e(function(e){P(t,e)},function(e){C(t,e)})}catch(e){C(t,e)}}var k=0;function W(){return k++}function q(t){t[S]=k++,t._state=void 0,t._result=void 0,t._subscribers=[]}function K(){return new Error("Array Methods must be provided an Array")}var z=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(w),this.promise[S]||q(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?F(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&F(this.promise,this._result))):C(this.promise,K())}return t.prototype._enumerate=function(t){for(var e=0;this._state===m&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===y){var o=void 0,i=void 0,a=!1;try{o=t.then}catch(t){a=!0,i=t}if(o===N&&t._state!==m)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===et){var u=new n(w);a?C(u,i):V(u,t,o),this._willSettleAt(u,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===m&&(this._remaining--,t===O?C(r,n):this._result[e]=n),0===this._remaining&&F(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;U(t,void 0,function(t){return n._settledAt(L,e,t)},function(t){return n._settledAt(O,e,t)})},t}();function X(t){return new z(this,t).promise}function J(t){var e=this;return r(t)?new e(function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}):new e(function(t,e){return e(new TypeError("You must pass an array to race."))})}function Z(t){var e=new this(w);return C(e,t),e}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function tt(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var et=function(){function t(e){this[S]=W(),this._result=this._state=void 0,this._subscribers=[],w!==e&&("function"!=typeof e&&$(),this instanceof t?Q(this,e):tt())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var n=this,r=n.constructor;return e(t)?n.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})}):n.then(t,t)},t}();function nt(){var t=void 0;if(void 0!==n.g)t=n.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=et}return et.prototype.then=N,et.all=X,et.race=J,et.resolve=y,et.reject=Z,et._setScheduler=s,et._setAsap=c,et._asap=u,et.polyfill=nt,et.Promise=et,et}()}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){"use strict";var t,e=n(64583).Promise,r=function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=function(t,n,r,o){return new(r||(r=e))(function(e,i){function a(t){try{s(o.next(t))}catch(t){i(t)}}function u(t){try{s(o.throw(t))}catch(t){i(t)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r(function(t){t(n)})).then(a,u)}s((o=o.apply(t,n||[])).next())})},i=function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=e.call(t,i)}catch(t){u=[6,t],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},a=new(function(){function t(){this.dbName="GrataPubfDB",this.storeName="GrataPubfDataFunction",this.version=1,this.db=null,this.initPromise=null}return t.prototype.isSupported=function(){return"undefined"!=typeof window&&"indexedDB"in window},t.prototype.init=function(){return o(this,void 0,void 0,function(){var t=this;return i(this,function(n){return this.initPromise?[2,this.initPromise]:this.isSupported()?(this.initPromise=new e(function(e,n){var r=indexedDB.open(t.dbName,t.version);r.onerror=function(){n(new Error("Failed to open IndexedDB"))},r.onsuccess=function(){t.db=r.result,e()},r.onupgradeneeded=function(e){var n=e.target.result;if(!n.objectStoreNames.contains(t.storeName)){var r=n.createObjectStore(t.storeName,{keyPath:"id"});r.createIndex("formula","formula",{unique:!0}),r.createIndex("company_id","company_id",{unique:!1}),r.createIndex("metric","metric",{unique:!1}),r.createIndex("as_of_date","as_of_date",{unique:!1}),r.createIndex("created_date","created_date",{unique:!1}),r.createIndex("updated_date","updated_date",{unique:!1})}}}),[2,this.initPromise]):(this.initPromise=e.resolve(),[2,this.initPromise])})})},t.prototype.getByFormula=function(t){return o(this,void 0,void 0,function(){var n=this;return i(this,function(r){return this.isSupported()&&this.db?[2,new e(function(e,r){var o,i=null===(o=n.db)||void 0===o?void 0:o.transaction([n.storeName],"readonly");if(i){var a=i.objectStore(n.storeName).index("formula").get(t);a.onsuccess=function(){e(a.result||null)},a.onerror=function(){r(new Error("Failed to retrieve data from IndexedDB"))}}else r(new Error("Failed to create transaction"))})]:[2,null]})})},t.prototype.insert=function(t){return o(this,void 0,void 0,function(){var n,o,a=this;return i(this,function(i){if(!this.isSupported()||!this.db)throw new Error("IndexedDB is not supported or not initialized");return n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}),o=r(r({},t),{id:n,created_date:Date.now(),updated_date:null}),[2,new e(function(t,e){var r,i=null===(r=a.db)||void 0===r?void 0:r.transaction([a.storeName],"readwrite");if(i){var u=i.objectStore(a.storeName).add(o);u.onsuccess=function(){t(n)},u.onerror=function(){e(new Error("Failed to insert data into IndexedDB"))}}else e(new Error("Failed to create transaction"))})]})})},t.prototype.update=function(t,n){return o(this,void 0,void 0,function(){var r=this;return i(this,function(o){if(!this.isSupported()||!this.db)throw new Error("IndexedDB is not supported or not initialized");return[2,new e(function(e,o){var i,a=null===(i=r.db)||void 0===i?void 0:i.transaction([r.storeName],"readwrite");if(a){var u=a.objectStore(r.storeName),s=u.get(t);s.onsuccess=function(){var t=s.result;if(t){t.response=n,t.updated_date=Date.now();var r=u.put(t);r.onsuccess=function(){e()},r.onerror=function(){o(new Error("Failed to update data in IndexedDB"))}}else o(new Error("Record not found"))},s.onerror=function(){o(new Error("Failed to retrieve data from IndexedDB"))}}else o(new Error("Failed to create transaction"))})]})})},t.prototype.delete=function(t){return o(this,void 0,void 0,function(){var n=this;return i(this,function(r){if(!this.isSupported()||!this.db)throw new Error("IndexedDB is not supported or not initialized");return[2,new e(function(e,r){var o,i=null===(o=n.db)||void 0===o?void 0:o.transaction([n.storeName],"readwrite");if(i){var a=i.objectStore(n.storeName).delete(t);a.onsuccess=function(){e()},a.onerror=function(){r(new Error("Failed to delete data from IndexedDB"))}}else r(new Error("Failed to create transaction"))})]})})},t.prototype.clearAll=function(){return o(this,void 0,void 0,function(){var t=this;return i(this,function(n){if(!this.isSupported()||!this.db)throw new Error("IndexedDB is not supported or not initialized");return[2,new e(function(e,n){var r,o=null===(r=t.db)||void 0===r?void 0:r.transaction([t.storeName],"readwrite");if(o){var i=o.objectStore(t.storeName).clear();i.onsuccess=function(){e()},i.onerror=function(){n(new Error("Failed to clear IndexedDB"))}}else n(new Error("Failed to create transaction"))})]})})},t}()),u="https://search-beta.grata.com/api";!function(t){t.GET="GET",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE",t.PATCH="PATCH"}(t||(t={}));var s,c=n(64583).Promise,l=function(t,e,n,r){return new(n||(n=c))(function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function u(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}s((r=r.apply(t,e||[])).next())})},d=function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=e.call(t,i)}catch(t){u=[6,t],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},f=function(){var t,e,n=null!==(e=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.partitionKey)&&void 0!==e?e:"default",r="".concat(n,"-auth-token");return localStorage.getItem(r)||""},_=function(e,n,r,o){return l(void 0,void 0,void 0,function(){var i;return d(this,function(a){switch(a.label){case 0:return i={"Content-Type":"application/json",Authorization:"Bearer ".concat(f())},n!==t.POST&&n!==t.PUT&&n!==t.PATCH?[3,2]:[4,fetch(e,{method:n,headers:i,body:JSON.stringify(r),signal:o})];case 1:case 3:return[2,a.sent()];case 2:return[4,fetch(e,{method:n,headers:i,signal:o})]}})})};function E(){return l(this,void 0,void 0,function(){var e,n,r,o,i,a,s,l;return d(this,function(d){switch(d.label){case 0:return d.trys.push([0,6,,7]),e=null!==(l=Office.context.partitionKey)&&void 0!==l?l:"default",(n=localStorage.getItem("".concat(e,"-user-data")))?(r=JSON.parse(n),[2,c.resolve(r)]):f()?[4,_("".concat(u,"/users/info/?detailed=true"),t.GET)]:[2,c.reject(new Error("No authentication token available"))];case 1:o=d.sent(),d.label=2;case 2:return d.trys.push([2,4,,5]),[4,o.json()];case 3:return i=d.sent(),localStorage.setItem("".concat(e,"-user-data"),JSON.stringify(i)),[2,i];case 4:return a=d.sent(),[2,c.reject(a.toString())];case 5:return[3,7];case 6:return s=d.sent(),[2,c.reject(s.toString())];case 7:return[2]}})})}!function(t){t.MIN_DATE_ERROR="UNDER_MIN_DATE"}(s||(s={}));var T,v,h=new Date(2020,0,1),p=function(t){if(!t||""===t)return"";var e="string"==typeof t?new Date(t):t,n=e.getUTCDate().toString().padStart(2,"0"),r=(e.getUTCMonth()+1).toString().padStart(2,"0"),o=e.getUTCFullYear().toString();return"".concat(n,"/").concat(r,"/").concat(o)},R=function(t){var e,n,r,o,i=null;if("number"==typeof t){var a=(e=t,n=Math.floor(e),r=n>=60?n-1:n,o=Date.UTC(1899,11,31),new Date(o+864e5*r));if(a<h)return s.MIN_DATE_ERROR;i=p(a)}else{var u=function(t){var e=t;t.includes("T")&&(e=t.split("T")[0]);var n=e.split("/");if(3!==n.length)return null;var r=parseInt(n[0],10),o=parseInt(n[1],10),i=parseInt(n[2],10);if(isNaN(r)||isNaN(o)||isNaN(i))return null;var a=new Date(Date.UTC(i,o-1,r));return a.getUTCFullYear()!==i||a.getUTCMonth()+1!==o||a.getUTCDate()!==r||isNaN(a.getTime())?null:a}(t);if(!(u instanceof Date)||isNaN(u.getTime()))return null;if(u<h)return s.MIN_DATE_ERROR;i=p(u)}return i};!function(t){t.SHARE_PRICE="Share Price",t.OUTSTANDING_SHARES="Outstanding Shares",t.MARKET_CAP="Market Cap",t.ENTERPRISE_VALUE="Enterprise Value",t.EV_REV_LTM="EV/Rev (LTM)",t.EV_EBITDA_LTM="EV/EBITDA (LTM)",t.PRICE_EARNINGS_RATIO="Price/Earnings Ratio",t.EV_EBIT_LTM="EV/EBIT (LTM)",t.EV_GROSS_PROFIT_LTM="EV/Gross Profit (LTM)",t.EV_REV_1Y="EV/Rev (+1Y)",t.EV_EBITDA_1Y="EV/EBITDA (+1Y)",t.REVENUE_LTM="Revenue (LTM)",t.EBITDA_LTM="EBITDA (LTM)",t.EBITDA_MARGIN_LTM="EBITDA Margin (LTM)",t.QTR_REV_GROWTH_YOY="Qtr Rev Growth (YoY)",t.GROSS_PROFIT_LTM="Gross Profit (LTM)",t.GROSS_MARGIN_LTM="Gross Margin (LTM)",t.EBIT_LTM="EBIT (LTM)",t.EBIT_MARGIN_LTM="EBIT Margin (LTM)",t.QUARTERLY_REVENUE="Quarterly Revenue",t.QTR_EARNINGS_GROWTH_YOY="Qtr Earnings Growth (YoY)",t.TAX_RATE_LTM="Tax Rate (LTM)",t.REVENUE_1Y="Revenue (+1Y)",t.EBITDA_1Y="EBITDA (+1Y)",t.NET_DEBT="Net Debt",t.DEBT_EQUITY_RATIO="Debt/Equity Ratio",t.OPERATING_CASH_FLOW_MARGIN_LTM="Operating Cash Flow Margin (LTM)",t.FREE_CASH_FLOW_MARGIN_LTM="Free Cash Flow Margin (LTM)"}(T||(T={})),function(t){t[t.SHARE_PRICE=1]="SHARE_PRICE",t[t.OUTSTANDING_SHARES=2]="OUTSTANDING_SHARES",t[t.MARKET_CAP=3]="MARKET_CAP",t[t.ENTERPRISE_VALUE=4]="ENTERPRISE_VALUE",t[t.EV_REV_LTM=5]="EV_REV_LTM",t[t.EV_EBITDA_LTM=6]="EV_EBITDA_LTM",t[t.PRICE_EARNINGS_RATIO=7]="PRICE_EARNINGS_RATIO",t[t.EV_EBIT_LTM=8]="EV_EBIT_LTM",t[t.EV_GROSS_PROFIT_LTM=9]="EV_GROSS_PROFIT_LTM",t[t.EV_REV_1Y=10]="EV_REV_1Y",t[t.EV_EBITDA_1Y=11]="EV_EBITDA_1Y",t[t.REVENUE_LTM=12]="REVENUE_LTM",t[t.EBITDA_LTM=13]="EBITDA_LTM",t[t.EBITDA_MARGIN_LTM=14]="EBITDA_MARGIN_LTM",t[t.QTR_REV_GROWTH_YOY=15]="QTR_REV_GROWTH_YOY",t[t.GROSS_PROFIT_LTM=16]="GROSS_PROFIT_LTM",t[t.GROSS_MARGIN_LTM=17]="GROSS_MARGIN_LTM",t[t.EBIT_LTM=18]="EBIT_LTM",t[t.EBIT_MARGIN_LTM=19]="EBIT_MARGIN_LTM",t[t.QUARTERLY_REVENUE=20]="QUARTERLY_REVENUE",t[t.QTR_EARNINGS_GROWTH_YOY=21]="QTR_EARNINGS_GROWTH_YOY",t[t.TAX_RATE_LTM=22]="TAX_RATE_LTM",t[t.REVENUE_1Y=23]="REVENUE_1Y",t[t.EBITDA_1Y=24]="EBITDA_1Y",t[t.NET_DEBT=25]="NET_DEBT",t[t.DEBT_EQUITY_RATIO=26]="DEBT_EQUITY_RATIO",t[t.OPERATING_CASH_FLOW_MARGIN_LTM=27]="OPERATING_CASH_FLOW_MARGIN_LTM",t[t.FREE_CASH_FLOW_MARGIN_LTM=28]="FREE_CASH_FLOW_MARGIN_LTM"}(v||(v={}));var I,A,b,M=[{label:"Valuation",items:[{id:v.SHARE_PRICE,label:T.SHARE_PRICE},{id:v.OUTSTANDING_SHARES,label:T.OUTSTANDING_SHARES},{id:v.MARKET_CAP,label:T.MARKET_CAP},{id:v.ENTERPRISE_VALUE,label:T.ENTERPRISE_VALUE},{id:v.EV_REV_LTM,label:T.EV_REV_LTM},{id:v.EV_EBITDA_LTM,label:T.EV_EBITDA_LTM},{id:v.PRICE_EARNINGS_RATIO,label:T.PRICE_EARNINGS_RATIO},{id:v.EV_EBIT_LTM,label:T.EV_EBIT_LTM},{id:v.EV_GROSS_PROFIT_LTM,label:T.EV_GROSS_PROFIT_LTM},{id:v.EV_REV_1Y,label:T.EV_REV_1Y},{id:v.EV_EBITDA_1Y,label:T.EV_EBITDA_1Y}]},{label:"Income Statement",items:[{id:v.REVENUE_LTM,label:T.REVENUE_LTM},{id:v.EBITDA_LTM,label:T.EBITDA_LTM},{id:v.EBITDA_MARGIN_LTM,label:T.EBITDA_MARGIN_LTM},{id:v.QTR_REV_GROWTH_YOY,label:T.QTR_REV_GROWTH_YOY},{id:v.GROSS_PROFIT_LTM,label:T.GROSS_PROFIT_LTM},{id:v.GROSS_MARGIN_LTM,label:T.GROSS_MARGIN_LTM},{id:v.EBIT_LTM,label:T.EBIT_LTM},{id:v.EBIT_MARGIN_LTM,label:T.EBIT_MARGIN_LTM},{id:v.QUARTERLY_REVENUE,label:T.QUARTERLY_REVENUE},{id:v.QTR_EARNINGS_GROWTH_YOY,label:T.QTR_EARNINGS_GROWTH_YOY},{id:v.TAX_RATE_LTM,label:T.TAX_RATE_LTM},{id:v.REVENUE_1Y,label:T.REVENUE_1Y},{id:v.EBITDA_1Y,label:T.EBITDA_1Y}]},{label:"Balance Sheet",items:[{id:v.NET_DEBT,label:T.NET_DEBT},{id:v.DEBT_EQUITY_RATIO,label:T.DEBT_EQUITY_RATIO}]},{label:"Cash Flow",items:[{id:v.OPERATING_CASH_FLOW_MARGIN_LTM,label:T.OPERATING_CASH_FLOW_MARGIN_LTM},{id:v.FREE_CASH_FLOW_MARGIN_LTM,label:T.FREE_CASH_FLOW_MARGIN_LTM}]}];!function(t){t.STAFF="STAFF",t.ADMIN="ADMIN",t.STANDARD="STANDARD"}(I||(I={})),function(t){t.TRIAL="TRIAL"}(A||(A={})),function(t){t.IN_TRIAL="In Trial",t.CANCELLING="Cancelling",t.LEGACY="Legacy",t.COMPLIMENTARY="Complimentary",t.TRIAL_EXPIRED="Trial Expired",t.NONE=""}(b||(b={}));var N;!function(t){t.UNAUTHORIZED="Sign In Required",t.FORBIDDEN="Access Required",t.INVALID_COMPANY_ID="Invalid Company ID",t.INVALID_METRIC="Invalid Metric",t.INVALID_DATE="Invalid Date",t.MIN_DATE_ERROR="Date must be after 2019"}(N||(N={}));var y=n(64583).Promise,S=function(t,e,n,r){return new(n||(n=y))(function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function u(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}s((r=r.apply(t,e||[])).next())})},w=function(t,e){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=e.call(t,i)}catch(t){u=[6,t],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},m=[],L=!1,O=!1,D=null;function g(){return S(this,void 0,void 0,function(){return w(this,function(t){return O?[2]:D?[2,D]:[2,D=a.init().then(function(){O=!0}).catch(function(t){console.error("Failed to initialize IndexedDB:",t)})]})})}function x(t){var e={request:t,done:!1,resolve:void 0},n=new y(function(t){e.resolve=t});return m.push(e),L||(L=!0,setTimeout(G,100)),n}function G(){var e=this,n=(null!=m?m:[]).splice(0,(null!=m?m:[]).length),r=function(t){for(var e,r,o=0;o<n.length;o++)null===(r=(e=n[o]).resolve)||void 0===r||r.call(e,"".concat(t)),n[o].done=!0};try{L=!1;var o=n.map(function(t,e){var n,r;return t.request.index=e,t.request.metric=(n=t.request.metric,r=M.flatMap(function(t){return t.items}).find(function(t){return t.label===n}),r?r.id:null),t.request});(function(e){return l(this,void 0,void 0,function(){var n,r,o;return d(this,function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),[4,_("".concat(u,"/excel/formula/"),t.POST,e)];case 1:n=i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,n.json()];case 3:return[2,i.sent()];case 4:return r=i.sent(),[2,c.reject(r.toString())];case 5:return[3,7];case 6:return o=i.sent(),[2,c.reject(o.toString())];case 7:return[2]}})})})({queries:o}).then(function(t){var i;if(0===(null!==(i=null==t?void 0:t.results)&&void 0!==i?i:[]).length)return r("No results"),void console.error("No results in response batch");t.results.forEach(function(t){return S(e,void 0,void 0,function(){var e,r,i,u,s,c,l,d,f,_,E;return w(this,function(T){switch(T.label){case 0:return-1===(e=o.findIndex(function(e){return e.index===t.index}))?(console.error("Mismatched response index: ".concat(t.index)),[2]):t.data?[3,1]:(null===(u=(i=n[e]).resolve)||void 0===u||u.call(i,null!==(s=null==t?void 0:t.error)&&void 0!==s?s:"Unknown error"),console.error("Error: ".concat(t.error)),[3,5]);case 1:if(null===(l=(c=n[e]).resolve)||void 0===l||l.call(c,"".concat(null===(f=null===(d=null==t?void 0:t.data)||void 0===d?void 0:d.value)||void 0===f?void 0:f.value," ").concat(null===(E=null===(_=null==t?void 0:t.data)||void 0===_?void 0:_.value)||void 0===E?void 0:E.currency)),!a.isSupported()||!n[e].dbRecordId)return[3,5];T.label=2;case 2:return T.trys.push([2,4,,5]),[4,a.update(n[e].dbRecordId,t)];case 3:return T.sent(),[3,5];case 4:return r=T.sent(),console.error("Failed to update cache in IndexedDB:",r),[3,5];case 5:return n[e].done=!0,[2]}})})})}).catch(function(t){r("Error: ".concat(t.toString())),console.error(t)}).finally(function(){r("Unknown error")})}catch(t){L=!1,r("Error: ".concat(t.toString())),console.error(t)}}function B(t,e,n){return S(this,void 0,void 0,function(){var r,o,i,u,s,c,l,d,f,_,E,T,v,h;return w(this,function(p){switch(p.label){case 0:if(r=function(t,e,n,r){void 0===r&&(r=!1);var o="=GRATA.PUBF(".concat(t,", ").concat(e,", ").concat(n,")");return r?o:o.toLowerCase()}(t,e,n),o=null,!a.isSupported())return[3,4];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,a.getByFormula(r)];case 2:return(o=p.sent())&&null!==o.response?[2,"".concat(null===(E=null===(_=null===(f=o.response)||void 0===f?void 0:f.data)||void 0===_?void 0:_.value)||void 0===E?void 0:E.value," ").concat(null===(h=null===(v=null===(T=o.response)||void 0===T?void 0:T.data)||void 0===v?void 0:v.value)||void 0===h?void 0:h.currency)]:[3,4];case 3:return i=p.sent(),console.error("Failed to retrieve from cache:",i),[3,4];case 4:if(u={companyId:t,metric:e,asOfDate:n,index:0},!a.isSupported())return[3,10];p.label=5;case 5:return p.trys.push([5,9,,10]),s="",o?[3,7]:[4,a.insert({company_id:t,metric:e,as_of_date:n,formula:r,response:null})];case 6:return s=p.sent(),[3,8];case 7:s=o.id,p.label=8;case 8:return c={request:u,done:!1,resolve:void 0,dbRecordId:s},l=new y(function(t){c.resolve=t}),m.push(c),L||(L=!0,setTimeout(G,100)),[2,l];case 9:return d=p.sent(),console.error("Failed to insert into cache:",d),[2,x(u)];case 10:return[2,x(u)]}})})}g().then(),CustomFunctions.associate("PUBF",function(t,e,n){return S(this,void 0,void 0,function(){var r,o,i;return w(this,function(a){switch(a.label){case 0:return r=function(){var t,e,n=null!==(e=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.partitionKey)&&void 0!==e?e:"default",r="".concat(n,"-auth-token");return localStorage.getItem(r)}(),r?[4,E()]:[2,N.UNAUTHORIZED];case 1:return function(t,e){var n,r,o,i,a=null!==(r=null===(n=null==t?void 0:t.settings)||void 0===n?void 0:n.product_access)&&void 0!==r?r:"",u=null!==(i=null===(o=null==e?void 0:e.settings)||void 0===o?void 0:o.product_access)&&void 0!==i?i:"";return!!a.includes("mr")||!!a.includes("mixed")&&u.includes("mr")}(null==(o=a.sent())?void 0:o.organization,null==o?void 0:o.user)?[4,g()]:[2,N.FORBIDDEN];case 2:return a.sent(),""===t?[2,N.INVALID_COMPANY_ID]:function(t){return M.some(function(e){return e.items.some(function(e){return e.label===t})})}(e)?(i=R(n))?i===s.MIN_DATE_ERROR?[2,N.MIN_DATE_ERROR]:[2,B(t,e,i)]:[2,N.INVALID_DATE]:[2,N.INVALID_METRIC]}})})})}()}();