!function(){var e={64583:function(e,t,n){e.exports=function(){"use strict";function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function t(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,i=void 0,a=void 0,u=function(e,t){I[o]=e,I[o+1]=t,2===(o+=2)&&(a?a(A):M())};function s(e){a=e}function c(e){u=e}var l="undefined"!=typeof window?window:void 0,d=l||{},f=d.MutationObserver||d.WebKitMutationObserver,_="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),E="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function T(){return function(){return process.nextTick(A)}}function v(){return void 0!==i?function(){i(A)}:p()}function h(){var e=0,t=new f(A),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function R(){var e=new MessageChannel;return e.port1.onmessage=A,function(){return e.port2.postMessage(0)}}function p(){var e=setTimeout;return function(){return e(A,1)}}var I=new Array(1e3);function A(){for(var e=0;e<o;e+=2)(0,I[e])(I[e+1]),I[e]=void 0,I[e+1]=void 0;o=0}function b(){try{var e=Function("return this")().require("vertx");return i=e.runOnLoop||e.runOnContext,v()}catch(e){return p()}}var M=void 0;function N(e,t){var n=this,r=new this.constructor(w);void 0===r[S]&&q(r);var o=n._state;if(o){var i=arguments[o-1];u(function(){return H(o,r,i,n._result)})}else U(n,r,e,t);return r}function y(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(w);return P(n,e),n}M=_?T():f?h():E?R():void 0===l?b():p();var S=Math.random().toString(36).substring(2);function w(){}var O=void 0,L=1,m=2;function D(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function x(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function G(e,t,n){u(function(e){var r=!1,o=x(n,t,function(n){r||(r=!0,t!==n?P(e,n):C(e,n))},function(t){r||(r=!0,F(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,F(e,o))},e)}function B(e,t){t._state===L?C(e,t._result):t._state===m?F(e,t._result):U(t,void 0,function(t){return P(e,t)},function(t){return F(e,t)})}function V(e,n,r){n.constructor===e.constructor&&r===N&&n.constructor.resolve===y?B(e,n):void 0===r?C(e,n):t(r)?G(e,n,r):C(e,n)}function P(t,n){if(t===n)F(t,D());else if(e(n)){var r=void 0;try{r=n.then}catch(e){return void F(t,e)}V(t,n,r)}else C(t,n)}function Y(e){e._onerror&&e._onerror(e._result),j(e)}function C(e,t){e._state===O&&(e._result=t,e._state=L,0!==e._subscribers.length&&u(j,e))}function F(e,t){e._state===O&&(e._state=m,e._result=t,u(Y,e))}function U(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+L]=n,o[i+m]=r,0===i&&e._state&&u(j,e)}function j(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,a=0;a<t.length;a+=3)r=t[a],o=t[a+n],r?H(n,r,o,i):o(i);e._subscribers.length=0}}function H(e,n,r,o){var i=t(r),a=void 0,u=void 0,s=!0;if(i){try{a=r(o)}catch(e){s=!1,u=e}if(n===a)return void F(n,g())}else a=o;n._state!==O||(i&&s?P(n,a):!1===s?F(n,u):e===L?C(n,a):e===m&&F(n,a))}function Q(e,t){try{t(function(t){P(e,t)},function(t){F(e,t)})}catch(t){F(e,t)}}var k=0;function W(){return k++}function q(e){e[S]=k++,e._state=void 0,e._result=void 0,e._subscribers=[]}function X(){return new Error("Array Methods must be provided an Array")}var K=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(w),this.promise[S]||q(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&C(this.promise,this._result))):F(this.promise,X())}return e.prototype._enumerate=function(e){for(var t=0;this._state===O&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===y){var o=void 0,i=void 0,a=!1;try{o=e.then}catch(e){a=!0,i=e}if(o===N&&e._state!==O)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===te){var u=new n(w);a?F(u,i):V(u,e,o),this._willSettleAt(u,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===O&&(this._remaining--,e===m?F(r,n):this._result[t]=n),0===this._remaining&&C(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;U(e,void 0,function(e){return n._settledAt(L,t,e)},function(e){return n._settledAt(m,t,e)})},e}();function z(e){return new K(this,e).promise}function J(e){var t=this;return r(e)?new t(function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})}function Z(e){var t=new this(w);return F(t,e),t}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ee(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var te=function(){function e(t){this[S]=W(),this._result=this._state=void 0,this._subscribers=[],w!==t&&("function"!=typeof t&&$(),this instanceof e?Q(this,t):ee())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var n=this,r=n.constructor;return t(e)?n.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})}):n.then(e,e)},e}();function ne(){var e=void 0;if(void 0!==n.g)e=n.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=te}return te.prototype.then=N,te.all=z,te.race=J,te.resolve=y,te.reject=Z,te._setScheduler=s,te._setAsap=c,te._asap=u,te.polyfill=ne,te.Promise=te,te}()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";var e,t=n(64583).Promise,r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function u(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r(function(e){e(n)})).then(a,u)}s((o=o.apply(e,n||[])).next())})},i=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},a=new(function(){function e(){this.dbName="GrataPubfDB",this.storeName="GrataPubfDataFunction",this.version=1,this.db=null,this.initPromise=null}return e.prototype.isSupported=function(){return"undefined"!=typeof window&&"indexedDB"in window},e.prototype.init=function(){return o(this,void 0,void 0,function(){var e=this;return i(this,function(n){return this.initPromise?[2,this.initPromise]:this.isSupported()?(this.initPromise=new t(function(t,n){var r=indexedDB.open(e.dbName,e.version);r.onerror=function(){n(new Error("Failed to open IndexedDB"))},r.onsuccess=function(){e.db=r.result,t()},r.onupgradeneeded=function(t){var n=t.target.result;if(!n.objectStoreNames.contains(e.storeName)){var r=n.createObjectStore(e.storeName,{keyPath:"id"});r.createIndex("formula","formula",{unique:!0}),r.createIndex("company_id","company_id",{unique:!1}),r.createIndex("metric","metric",{unique:!1}),r.createIndex("as_of_date","as_of_date",{unique:!1}),r.createIndex("created_date","created_date",{unique:!1}),r.createIndex("updated_date","updated_date",{unique:!1})}}}),[2,this.initPromise]):(this.initPromise=t.resolve(),[2,this.initPromise])})})},e.prototype.getByFormula=function(e){return o(this,void 0,void 0,function(){var n=this;return i(this,function(r){return this.isSupported()&&this.db?[2,new t(function(t,r){var o,i=null===(o=n.db)||void 0===o?void 0:o.transaction([n.storeName],"readonly");if(i){var a=i.objectStore(n.storeName).index("formula").get(e);a.onsuccess=function(){t(a.result||null)},a.onerror=function(){r(new Error("Failed to retrieve data from IndexedDB"))}}else r(new Error("Failed to create transaction"))})]:[2,null]})})},e.prototype.insert=function(e){return o(this,void 0,void 0,function(){var n,o,a=this;return i(this,function(i){if(!this.isSupported()||!this.db)throw new Error("IndexedDB is not supported or not initialized");return n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),o=r(r({},e),{id:n,created_date:Date.now(),updated_date:null}),[2,new t(function(e,t){var r,i=null===(r=a.db)||void 0===r?void 0:r.transaction([a.storeName],"readwrite");if(i){var u=i.objectStore(a.storeName).add(o);u.onsuccess=function(){e(n)},u.onerror=function(){t(new Error("Failed to insert data into IndexedDB"))}}else t(new Error("Failed to create transaction"))})]})})},e.prototype.update=function(e,n){return o(this,void 0,void 0,function(){var r=this;return i(this,function(o){if(!this.isSupported()||!this.db)throw new Error("IndexedDB is not supported or not initialized");return[2,new t(function(t,o){var i,a=null===(i=r.db)||void 0===i?void 0:i.transaction([r.storeName],"readwrite");if(a){var u=a.objectStore(r.storeName),s=u.get(e);s.onsuccess=function(){var e=s.result;if(e){e.response=n,e.updated_date=Date.now();var r=u.put(e);r.onsuccess=function(){t()},r.onerror=function(){o(new Error("Failed to update data in IndexedDB"))}}else o(new Error("Record not found"))},s.onerror=function(){o(new Error("Failed to retrieve data from IndexedDB"))}}else o(new Error("Failed to create transaction"))})]})})},e.prototype.delete=function(e){return o(this,void 0,void 0,function(){var n=this;return i(this,function(r){if(!this.isSupported()||!this.db)throw new Error("IndexedDB is not supported or not initialized");return[2,new t(function(t,r){var o,i=null===(o=n.db)||void 0===o?void 0:o.transaction([n.storeName],"readwrite");if(i){var a=i.objectStore(n.storeName).delete(e);a.onsuccess=function(){t()},a.onerror=function(){r(new Error("Failed to delete data from IndexedDB"))}}else r(new Error("Failed to create transaction"))})]})})},e.prototype.clearAll=function(){return o(this,void 0,void 0,function(){var e=this;return i(this,function(n){if(!this.isSupported()||!this.db)throw new Error("IndexedDB is not supported or not initialized");return[2,new t(function(t,n){var r,o=null===(r=e.db)||void 0===r?void 0:r.transaction([e.storeName],"readwrite");if(o){var i=o.objectStore(e.storeName).clear();i.onsuccess=function(){t()},i.onerror=function(){n(new Error("Failed to clear IndexedDB"))}}else n(new Error("Failed to create transaction"))})]})})},e}()),u="https://search-beta.grata.com/api";!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE",e.PATCH="PATCH"}(e||(e={}));var s,c=n(64583).Promise,l=function(e,t,n,r){return new(n||(n=c))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,u)}s((r=r.apply(e,t||[])).next())})},d=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},f=function(){var e,t,n=null!==(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.partitionKey)&&void 0!==t?t:"default",r="".concat(n,"-auth-token");return localStorage.getItem(r)||""},_=function(t,n,r,o){return l(void 0,void 0,void 0,function(){var i;return d(this,function(a){switch(a.label){case 0:return i={"Content-Type":"application/json",Authorization:"Bearer ".concat(f())},n!==e.POST&&n!==e.PUT&&n!==e.PATCH?[3,2]:[4,fetch(t,{method:n,headers:i,body:JSON.stringify(r),signal:o})];case 1:case 3:return[2,a.sent()];case 2:return[4,fetch(t,{method:n,headers:i,signal:o})]}})})};function E(){return l(this,void 0,void 0,function(){var t,n,r,o,i,a,s,l;return d(this,function(d){switch(d.label){case 0:return d.trys.push([0,6,,7]),t=null!==(l=Office.context.partitionKey)&&void 0!==l?l:"default",(n=localStorage.getItem("".concat(t,"-user-data")))?(r=JSON.parse(n),[2,c.resolve(r)]):f()?[4,_("".concat(u,"/users/info/?detailed=true"),e.GET)]:[2,c.reject(new Error("No authentication token available"))];case 1:o=d.sent(),d.label=2;case 2:return d.trys.push([2,4,,5]),[4,o.json()];case 3:return i=d.sent(),localStorage.setItem("".concat(t,"-user-data"),JSON.stringify(i)),[2,i];case 4:return a=d.sent(),[2,c.reject(a.toString())];case 5:return[3,7];case 6:return s=d.sent(),[2,c.reject(s.toString())];case 7:return[2]}})})}!function(e){e.MIN_DATE_ERROR="UNDER_MIN_DATE",e.MAX_DATE_ERROR="OVER_MAX_DATE"}(s||(s={}));var T,v,h=new Date(2020,0,1),R=new Date,p=function(e){if(!e||""===e)return"";var t="string"==typeof e?new Date(e):e,n=t.getUTCDate().toString().padStart(2,"0"),r=(t.getUTCMonth()+1).toString().padStart(2,"0"),o=t.getUTCFullYear().toString();return"".concat(n,"/").concat(r,"/").concat(o)},I=function(e){var t,n,r,o,i=null;if("number"==typeof e){var a=(t=e,n=Math.floor(t),r=n>=60?n-1:n,o=Date.UTC(1899,11,31),new Date(o+864e5*r));if(a<h)return s.MIN_DATE_ERROR;if(a>R)return s.MAX_DATE_ERROR;i=p(a)}else{var u=function(e){var t=e;e.includes("T")&&(t=e.split("T")[0]);var n=t.split("/");if(3!==n.length)return null;var r=parseInt(n[0],10),o=parseInt(n[1],10),i=parseInt(n[2],10);if(isNaN(r)||isNaN(o)||isNaN(i))return null;var a=new Date(Date.UTC(i,o-1,r));return a.getUTCFullYear()!==i||a.getUTCMonth()+1!==o||a.getUTCDate()!==r||isNaN(a.getTime())?null:a}(e);if(!(u instanceof Date)||isNaN(u.getTime()))return null;if(u<h)return s.MIN_DATE_ERROR;if(u>R)return s.MAX_DATE_ERROR;i=p(u)}return i};!function(e){e.SHARE_PRICE="Share Price",e.OUTSTANDING_SHARES="Outstanding Shares",e.MARKET_CAP="Market Cap",e.ENTERPRISE_VALUE="Enterprise Value",e.EV_REV_LTM="EV/Rev (LTM)",e.EV_EBITDA_LTM="EV/EBITDA (LTM)",e.PRICE_EARNINGS_RATIO="Price/Earnings Ratio",e.EV_EBIT_LTM="EV/EBIT (LTM)",e.EV_GROSS_PROFIT_LTM="EV/Gross Profit (LTM)",e.EV_REV_1Y="EV/Rev (+1Y)",e.EV_EBITDA_1Y="EV/EBITDA (+1Y)",e.REVENUE_LTM="Revenue (LTM)",e.EBITDA_LTM="EBITDA (LTM)",e.EBITDA_MARGIN_LTM="EBITDA Margin (LTM)",e.QTR_REV_GROWTH_YOY="Qtr Rev Growth (YoY)",e.GROSS_PROFIT_LTM="Gross Profit (LTM)",e.GROSS_MARGIN_LTM="Gross Margin (LTM)",e.EBIT_LTM="EBIT (LTM)",e.EBIT_MARGIN_LTM="EBIT Margin (LTM)",e.QUARTERLY_REVENUE="Quarterly Revenue",e.QTR_EARNINGS_GROWTH_YOY="Qtr Earnings Growth (YoY)",e.TAX_RATE_LTM="Tax Rate (LTM)",e.REVENUE_1Y="Revenue (+1Y)",e.EBITDA_1Y="EBITDA (+1Y)",e.NET_DEBT="Net Debt",e.DEBT_EQUITY_RATIO="Debt/Equity Ratio",e.OPERATING_CASH_FLOW_MARGIN_LTM="Operating Cash Flow Margin (LTM)",e.FREE_CASH_FLOW_MARGIN_LTM="Free Cash Flow Margin (LTM)"}(T||(T={})),function(e){e[e.SHARE_PRICE=1]="SHARE_PRICE",e[e.OUTSTANDING_SHARES=2]="OUTSTANDING_SHARES",e[e.MARKET_CAP=3]="MARKET_CAP",e[e.ENTERPRISE_VALUE=4]="ENTERPRISE_VALUE",e[e.EV_REV_LTM=5]="EV_REV_LTM",e[e.EV_EBITDA_LTM=6]="EV_EBITDA_LTM",e[e.PRICE_EARNINGS_RATIO=7]="PRICE_EARNINGS_RATIO",e[e.EV_EBIT_LTM=8]="EV_EBIT_LTM",e[e.EV_GROSS_PROFIT_LTM=9]="EV_GROSS_PROFIT_LTM",e[e.EV_REV_1Y=10]="EV_REV_1Y",e[e.EV_EBITDA_1Y=11]="EV_EBITDA_1Y",e[e.REVENUE_LTM=12]="REVENUE_LTM",e[e.EBITDA_LTM=13]="EBITDA_LTM",e[e.EBITDA_MARGIN_LTM=14]="EBITDA_MARGIN_LTM",e[e.QTR_REV_GROWTH_YOY=15]="QTR_REV_GROWTH_YOY",e[e.GROSS_PROFIT_LTM=16]="GROSS_PROFIT_LTM",e[e.GROSS_MARGIN_LTM=17]="GROSS_MARGIN_LTM",e[e.EBIT_LTM=18]="EBIT_LTM",e[e.EBIT_MARGIN_LTM=19]="EBIT_MARGIN_LTM",e[e.QUARTERLY_REVENUE=20]="QUARTERLY_REVENUE",e[e.QTR_EARNINGS_GROWTH_YOY=21]="QTR_EARNINGS_GROWTH_YOY",e[e.TAX_RATE_LTM=22]="TAX_RATE_LTM",e[e.REVENUE_1Y=23]="REVENUE_1Y",e[e.EBITDA_1Y=24]="EBITDA_1Y",e[e.NET_DEBT=25]="NET_DEBT",e[e.DEBT_EQUITY_RATIO=26]="DEBT_EQUITY_RATIO",e[e.OPERATING_CASH_FLOW_MARGIN_LTM=27]="OPERATING_CASH_FLOW_MARGIN_LTM",e[e.FREE_CASH_FLOW_MARGIN_LTM=28]="FREE_CASH_FLOW_MARGIN_LTM"}(v||(v={}));var A,b,M,N=[{label:"Valuation",items:[{id:v.SHARE_PRICE,label:T.SHARE_PRICE},{id:v.OUTSTANDING_SHARES,label:T.OUTSTANDING_SHARES},{id:v.MARKET_CAP,label:T.MARKET_CAP},{id:v.ENTERPRISE_VALUE,label:T.ENTERPRISE_VALUE},{id:v.EV_REV_LTM,label:T.EV_REV_LTM},{id:v.EV_EBITDA_LTM,label:T.EV_EBITDA_LTM},{id:v.PRICE_EARNINGS_RATIO,label:T.PRICE_EARNINGS_RATIO},{id:v.EV_EBIT_LTM,label:T.EV_EBIT_LTM},{id:v.EV_GROSS_PROFIT_LTM,label:T.EV_GROSS_PROFIT_LTM},{id:v.EV_REV_1Y,label:T.EV_REV_1Y},{id:v.EV_EBITDA_1Y,label:T.EV_EBITDA_1Y}]},{label:"Income Statement",items:[{id:v.REVENUE_LTM,label:T.REVENUE_LTM},{id:v.EBITDA_LTM,label:T.EBITDA_LTM},{id:v.EBITDA_MARGIN_LTM,label:T.EBITDA_MARGIN_LTM},{id:v.QTR_REV_GROWTH_YOY,label:T.QTR_REV_GROWTH_YOY},{id:v.GROSS_PROFIT_LTM,label:T.GROSS_PROFIT_LTM},{id:v.GROSS_MARGIN_LTM,label:T.GROSS_MARGIN_LTM},{id:v.EBIT_LTM,label:T.EBIT_LTM},{id:v.EBIT_MARGIN_LTM,label:T.EBIT_MARGIN_LTM},{id:v.QUARTERLY_REVENUE,label:T.QUARTERLY_REVENUE},{id:v.QTR_EARNINGS_GROWTH_YOY,label:T.QTR_EARNINGS_GROWTH_YOY},{id:v.TAX_RATE_LTM,label:T.TAX_RATE_LTM},{id:v.REVENUE_1Y,label:T.REVENUE_1Y},{id:v.EBITDA_1Y,label:T.EBITDA_1Y}]},{label:"Balance Sheet",items:[{id:v.NET_DEBT,label:T.NET_DEBT},{id:v.DEBT_EQUITY_RATIO,label:T.DEBT_EQUITY_RATIO}]},{label:"Cash Flow",items:[{id:v.OPERATING_CASH_FLOW_MARGIN_LTM,label:T.OPERATING_CASH_FLOW_MARGIN_LTM},{id:v.FREE_CASH_FLOW_MARGIN_LTM,label:T.FREE_CASH_FLOW_MARGIN_LTM}]}];!function(e){e.STAFF="STAFF",e.ADMIN="ADMIN",e.STANDARD="STANDARD"}(A||(A={})),function(e){e.TRIAL="TRIAL"}(b||(b={})),function(e){e.IN_TRIAL="In Trial",e.CANCELLING="Cancelling",e.LEGACY="Legacy",e.COMPLIMENTARY="Complimentary",e.TRIAL_EXPIRED="Trial Expired",e.NONE=""}(M||(M={}));var y;!function(e){e.UNAUTHORIZED="Sign In Required",e.FORBIDDEN="Access Required",e.INVALID_COMPANY_ID="Invalid Company ID",e.INVALID_METRIC="Invalid Metric",e.INVALID_DATE="Invalid Date",e.MIN_DATE_ERROR="Date must be after 2019",e.MAX_DATE_ERROR="No future dates allowed"}(y||(y={}));var S=n(64583).Promise,w=function(e,t,n,r){return new(n||(n=S))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,u)}s((r=r.apply(e,t||[])).next())})},O=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=u(0),a.throw=u(1),a.return=u(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},L=[],m=!1,D=!1,g=null;function x(){return w(this,void 0,void 0,function(){return O(this,function(e){return D?[2]:g?[2,g]:[2,g=a.init().then(function(){D=!0}).catch(function(e){console.error("Failed to initialize IndexedDB:",e)})]})})}function G(e){var t={request:e,done:!1,resolve:void 0},n=new S(function(e){t.resolve=e});return L.push(t),m||(m=!0,setTimeout(B,100)),n}function B(){var t=this,n=(null!=L?L:[]).splice(0,(null!=L?L:[]).length),r=function(e){for(var t,r,o=0;o<n.length;o++)null===(r=(t=n[o]).resolve)||void 0===r||r.call(t,"".concat(e)),n[o].done=!0};try{m=!1;var o=n.map(function(e,t){var n,r;return e.request.index=t,e.request.metric=(n=e.request.metric,r=N.flatMap(function(e){return e.items}).find(function(e){return e.label.toLowerCase()===n.toLowerCase()}),r?r.id:null),e.request});(function(t){return l(this,void 0,void 0,function(){var n,r,o;return d(this,function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),[4,_("".concat(u,"/excel/formula/"),e.POST,t)];case 1:n=i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,n.json()];case 3:return[2,i.sent()];case 4:return r=i.sent(),[2,c.reject(r.toString())];case 5:return[3,7];case 6:return o=i.sent(),[2,c.reject(o.toString())];case 7:return[2]}})})})({queries:o}).then(function(e){var i;if(0===(null!==(i=null==e?void 0:e.results)&&void 0!==i?i:[]).length)return r("No results"),void console.error("No results in response batch");e.results.forEach(function(e){return w(t,void 0,void 0,function(){var t,r,i,u,s,c,l,d,f,_,E,T,v,h,R,p,I,A;return O(this,function(b){switch(b.label){case 0:return-1===(t=o.findIndex(function(t){return t.index===e.index}))?(console.error("Mismatched response index: ".concat(e.index)),[2]):e.data?[3,1]:(null===(u=(i=n[t]).resolve)||void 0===u||u.call(i,null!==(s=null==e?void 0:e.error)&&void 0!==s?s:"Unknown error"),console.error("Error: ".concat(e.error)),[3,6]);case 1:return null!==(null!==(d=null===(l=null===(c=null==e?void 0:e.data)||void 0===c?void 0:c.value)||void 0===l?void 0:l.value)&&void 0!==d?d:null)?[3,2]:(null===(_=(f=n[t]).resolve)||void 0===_||_.call(f,"No data found"),[3,6]);case 2:if(null===(T=(E=n[t]).resolve)||void 0===T||T.call(E,"".concat(null!==(R=null===(h=null===(v=null==e?void 0:e.data)||void 0===v?void 0:v.value)||void 0===h?void 0:h.value)&&void 0!==R?R:0," ").concat(null!==(A=null===(I=null===(p=null==e?void 0:e.data)||void 0===p?void 0:p.value)||void 0===I?void 0:I.currency)&&void 0!==A?A:"")),!a.isSupported()||!n[t].dbRecordId)return[3,6];b.label=3;case 3:return b.trys.push([3,5,,6]),[4,a.update(n[t].dbRecordId,e)];case 4:return b.sent(),[3,6];case 5:return r=b.sent(),console.error("Failed to update cache in IndexedDB:",r),[3,6];case 6:return n[t].done=!0,[2]}})})})}).catch(function(e){r("Error: ".concat(e.toString())),console.error(e)}).finally(function(){r("Unknown error")})}catch(e){m=!1,r("Error: ".concat(e.toString())),console.error(e)}}function V(e,t,n){return w(this,void 0,void 0,function(){var r,o,i,u,s,c,l,d,f,_,E,T,v,h;return O(this,function(R){switch(R.label){case 0:if(r=function(e,t,n,r){void 0===r&&(r=!1);var o="=GRATA.PUBF(".concat(e,", ").concat(t,", ").concat(n,")");return r?o:o.toLowerCase()}(e,t,n),o=null,!a.isSupported())return[3,4];R.label=1;case 1:return R.trys.push([1,3,,4]),[4,a.getByFormula(r)];case 2:return(o=R.sent())&&null!==o.response?[2,"".concat(null===(E=null===(_=null===(f=o.response)||void 0===f?void 0:f.data)||void 0===_?void 0:_.value)||void 0===E?void 0:E.value," ").concat(null===(h=null===(v=null===(T=o.response)||void 0===T?void 0:T.data)||void 0===v?void 0:v.value)||void 0===h?void 0:h.currency)]:[3,4];case 3:return i=R.sent(),console.error("Failed to retrieve from cache:",i),[3,4];case 4:if(u={companyId:e,metric:t,asOfDate:n,index:0},!a.isSupported())return[3,10];R.label=5;case 5:return R.trys.push([5,9,,10]),s="",o?[3,7]:[4,a.insert({company_id:e,metric:t,as_of_date:n,formula:r,response:null})];case 6:return s=R.sent(),[3,8];case 7:s=o.id,R.label=8;case 8:return c={request:u,done:!1,resolve:void 0,dbRecordId:s},l=new S(function(e){c.resolve=e}),L.push(c),m||(m=!0,setTimeout(B,100)),[2,l];case 9:return d=R.sent(),console.error("Failed to insert into cache:",d),[2,G(u)];case 10:return[2,G(u)]}})})}x().then(),CustomFunctions.associate("PUBF",function(e,t,n){return w(this,void 0,void 0,function(){var r,o,i;return O(this,function(a){switch(a.label){case 0:return r=function(){var e,t,n=null!==(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.partitionKey)&&void 0!==t?t:"default",r="".concat(n,"-auth-token");return localStorage.getItem(r)}(),r?[4,E()]:[2,y.UNAUTHORIZED];case 1:return function(e,t){var n,r,o,i,a=null!==(r=null===(n=null==e?void 0:e.settings)||void 0===n?void 0:n.product_access)&&void 0!==r?r:"",u=null!==(i=null===(o=null==t?void 0:t.settings)||void 0===o?void 0:o.product_access)&&void 0!==i?i:"";return!!a.includes("mr")||!!a.includes("mixed")&&u.includes("mr")}(null==(o=a.sent())?void 0:o.organization,null==o?void 0:o.user)?[4,x()]:[2,y.FORBIDDEN];case 2:return a.sent(),""===e?[2,y.INVALID_COMPANY_ID]:function(e){return N.some(function(t){return t.items.some(function(t){return t.label.toLowerCase()===e.toLowerCase()})})}(t)?(i=I(n))?i===s.MIN_DATE_ERROR?[2,y.MIN_DATE_ERROR]:i===s.MAX_DATE_ERROR?[2,y.MAX_DATE_ERROR]:[2,V(e,t,i)]:[2,y.INVALID_DATE]:[2,y.INVALID_METRIC]}})})})}()}();