!function(){var e={64583:function(e,t,n){e.exports=function(){"use strict";function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function t(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,i=void 0,c=void 0,a=function(e,t){b[o]=e,b[o+1]=t,2===(o+=2)&&(c?c(_):k())};function s(e){c=e}function u(e){a=e}var l="undefined"!=typeof window?window:void 0,f=l||{},d=f.MutationObserver||f.WebKitMutationObserver,h="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),v="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){return function(){return process.nextTick(_)}}function m(){return void 0!==i?function(){i(_)}:w()}function g(){var e=0,t=new d(_),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function y(){var e=new MessageChannel;return e.port1.onmessage=_,function(){return e.port2.postMessage(0)}}function w(){var e=setTimeout;return function(){return e(_,1)}}var b=new Array(1e3);function _(){for(var e=0;e<o;e+=2)(0,b[e])(b[e+1]),b[e]=void 0,b[e+1]=void 0;o=0}function S(){try{var e=Function("return this")().require("vertx");return i=e.runOnLoop||e.runOnContext,m()}catch(e){return w()}}var k=void 0;function O(e,t){var n=this,r=new this.constructor(T);void 0===r[I]&&Y(r);var o=n._state;if(o){var i=arguments[o-1];a(function(){return H(o,r,i,n._result)})}else q(n,r,e,t);return r}function A(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(T);return N(n,e),n}k=h?p():d?g():v?y():void 0===l?S():w();var I=Math.random().toString(36).substring(2);function T(){}var x=void 0,E=1,C=2;function L(){return new TypeError("You cannot resolve a promise with itself")}function D(){return new TypeError("A promises callback cannot return that same promise.")}function M(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function R(e,t,n){a(function(e){var r=!1,o=M(n,t,function(n){r||(r=!0,t!==n?N(e,n):B(e,n))},function(t){r||(r=!0,P(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,P(e,o))},e)}function F(e,t){t._state===E?B(e,t._result):t._state===C?P(e,t._result):q(t,void 0,function(t){return N(e,t)},function(t){return P(e,t)})}function j(e,n,r){n.constructor===e.constructor&&r===O&&n.constructor.resolve===A?F(e,n):void 0===r?B(e,n):t(r)?R(e,n,r):B(e,n)}function N(t,n){if(t===n)P(t,L());else if(e(n)){var r=void 0;try{r=n.then}catch(e){return void P(t,e)}j(t,n,r)}else B(t,n)}function W(e){e._onerror&&e._onerror(e._result),U(e)}function B(e,t){e._state===x&&(e._result=t,e._state=E,0!==e._subscribers.length&&a(U,e))}function P(e,t){e._state===x&&(e._state=C,e._result=t,a(W,e))}function q(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+E]=n,o[i+C]=r,0===i&&e._state&&a(U,e)}function U(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,c=0;c<t.length;c+=3)r=t[c],o=t[c+n],r?H(n,r,o,i):o(i);e._subscribers.length=0}}function H(e,n,r,o){var i=t(r),c=void 0,a=void 0,s=!0;if(i){try{c=r(o)}catch(e){s=!1,a=e}if(n===c)return void P(n,D())}else c=o;n._state!==x||(i&&s?N(n,c):!1===s?P(n,a):e===E?B(n,c):e===C&&P(n,c))}function J(e,t){try{t(function(t){N(e,t)},function(t){P(e,t)})}catch(t){P(e,t)}}var G=0;function K(){return G++}function Y(e){e[I]=G++,e._state=void 0,e._result=void 0,e._subscribers=[]}function z(){return new Error("Array Methods must be provided an Array")}var X=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(T),this.promise[I]||Y(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?B(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&B(this.promise,this._result))):P(this.promise,z())}return e.prototype._enumerate=function(e){for(var t=0;this._state===x&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===A){var o=void 0,i=void 0,c=!1;try{o=e.then}catch(e){c=!0,i=e}if(o===O&&e._state!==x)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===te){var a=new n(T);c?P(a,i):j(a,e,o),this._willSettleAt(a,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===x&&(this._remaining--,e===C?P(r,n):this._result[t]=n),0===this._remaining&&B(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;q(e,void 0,function(e){return n._settledAt(E,t,e)},function(e){return n._settledAt(C,t,e)})},e}();function Q(e){return new X(this,e).promise}function V(e){var t=this;return r(e)?new t(function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})}function Z(e){var t=new this(T);return P(t,e),t}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ee(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var te=function(){function e(t){this[I]=K(),this._result=this._state=void 0,this._subscribers=[],T!==t&&("function"!=typeof t&&$(),this instanceof e?J(this,t):ee())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var n=this,r=n.constructor;return t(e)?n.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})}):n.then(e,e)},e}();function ne(){var e=void 0;if(void 0!==n.g)e=n.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=te}return te.prototype.then=O,te.all=Q,te.race=V,te.resolve=A,te.reject=Z,te._setScheduler=s,te._setAsap=u,te._asap=a,te.polyfill=ne,te.Promise=te,te}()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";var e,t,r,o=null!==(e="1.1.89")?e:"1.0.0",i=null!==(t="prod")?t:"dev",c=null!==(r="https://cesar-zavala-grata.github.io/grata-excel-build/")?r:"",a=n(64583).Promise;"function"==typeof SuppressedError&&SuppressedError;var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function u(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function l(e,t){return e(t={exports:{}},t.exports),t.exports}var f=l(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.locked=new Map,this.addToLocked=function(t,n){var r=e.locked.get(t);void 0===r?void 0===n?e.locked.set(t,[]):e.locked.set(t,[n]):void 0!==n&&(r.unshift(n),e.locked.set(t,r))},this.isLocked=function(t){return e.locked.has(t)},this.lock=function(t){return new a(function(n,r){e.isLocked(t)?e.addToLocked(t,n):(e.addToLocked(t),n())})},this.unlock=function(t){var n=e.locked.get(t);if(void 0!==n&&0!==n.length){var r=n.pop();e.locked.set(t,n),void 0!==r&&setTimeout(r,0)}else e.locked.delete(t)}}return e.getInstance=function(){return void 0===e.instance&&(e.instance=new e),e.instance},e}();t.default=function(){return n.getInstance()}});u(f);var d=u(l(function(e,t){var n=s&&s.__awaiter||function(e,t,n,r){return new(n||(n=a))(function(o,i){function c(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(c,a)}s((r=r.apply(e,t||[])).next())})},r=s&&s.__generator||function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},o=s;Object.defineProperty(t,"__esModule",{value:!0});var i="browser-tabs-lock-key",c={key:function(e){return n(o,void 0,void 0,function(){return r(this,function(e){throw new Error("Unsupported")})})},getItem:function(e){return n(o,void 0,void 0,function(){return r(this,function(e){throw new Error("Unsupported")})})},clear:function(){return n(o,void 0,void 0,function(){return r(this,function(e){return[2,window.localStorage.clear()]})})},removeItem:function(e){return n(o,void 0,void 0,function(){return r(this,function(e){throw new Error("Unsupported")})})},setItem:function(e,t){return n(o,void 0,void 0,function(){return r(this,function(e){throw new Error("Unsupported")})})},keySync:function(e){return window.localStorage.key(e)},getItemSync:function(e){return window.localStorage.getItem(e)},clearSync:function(){return window.localStorage.clear()},removeItemSync:function(e){return window.localStorage.removeItem(e)},setItemSync:function(e,t){return window.localStorage.setItem(e,t)}};function u(e){return new a(function(t){return setTimeout(t,e)})}function l(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",n="",r=0;r<e;r++)n+=t[Math.floor(61*Math.random())];return n}var d=function(){function e(t){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=Date.now().toString()+l(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=t,void 0===e.waiters&&(e.waiters=[])}return e.prototype.acquireLock=function(t,o){return void 0===o&&(o=5e3),n(this,void 0,void 0,function(){var n,a,s,f,d,h,v;return r(this,function(r){switch(r.label){case 0:n=Date.now()+l(4),a=Date.now()+o,s=i+"-"+t,f=void 0===this.storageHandler?c:this.storageHandler,r.label=1;case 1:return Date.now()<a?[4,u(30)]:[3,8];case 2:return r.sent(),null!==f.getItemSync(s)?[3,5]:(d=this.id+"-"+t+"-"+n,[4,u(Math.floor(25*Math.random()))]);case 3:return r.sent(),f.setItemSync(s,JSON.stringify({id:this.id,iat:n,timeoutKey:d,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,u(30)];case 4:return r.sent(),null!==(h=f.getItemSync(s))&&(v=JSON.parse(h)).id===this.id&&v.iat===n?(this.acquiredIatSet.add(n),this.refreshLockWhileAcquired(s,n),[2,!0]):[3,7];case 5:return e.lockCorrector(void 0===this.storageHandler?c:this.storageHandler),[4,this.waitForSomethingToChange(a)];case 6:r.sent(),r.label=7;case 7:return n=Date.now()+l(4),[3,1];case 8:return[2,!1]}})})},e.prototype.refreshLockWhileAcquired=function(e,t){return n(this,void 0,void 0,function(){var o=this;return r(this,function(i){return setTimeout(function(){return n(o,void 0,void 0,function(){var n,o,i;return r(this,function(r){switch(r.label){case 0:return[4,f.default().lock(t)];case 1:return r.sent(),this.acquiredIatSet.has(t)?(n=void 0===this.storageHandler?c:this.storageHandler,null===(o=n.getItemSync(e))?(f.default().unlock(t),[2]):((i=JSON.parse(o)).timeRefreshed=Date.now(),n.setItemSync(e,JSON.stringify(i)),f.default().unlock(t),this.refreshLockWhileAcquired(e,t),[2])):(f.default().unlock(t),[2])}})})},1e3),[2]})})},e.prototype.waitForSomethingToChange=function(t){return n(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,new a(function(n){var r=!1,o=Date.now(),i=!1;function c(){if(i||(window.removeEventListener("storage",c),e.removeFromWaiting(c),clearTimeout(a),i=!0),!r){r=!0;var t=50-(Date.now()-o);t>0?setTimeout(n,t):n(null)}}window.addEventListener("storage",c),e.addToWaiting(c);var a=setTimeout(c,Math.max(0,t-Date.now()))})];case 1:return n.sent(),[2]}})})},e.addToWaiting=function(t){this.removeFromWaiting(t),void 0!==e.waiters&&e.waiters.push(t)},e.removeFromWaiting=function(t){void 0!==e.waiters&&(e.waiters=e.waiters.filter(function(e){return e!==t}))},e.notifyWaiters=function(){void 0!==e.waiters&&e.waiters.slice().forEach(function(e){return e()})},e.prototype.releaseLock=function(e){return n(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,this.releaseLock__private__(e)];case 1:return[2,t.sent()]}})})},e.prototype.releaseLock__private__=function(t){return n(this,void 0,void 0,function(){var n,o,a,s;return r(this,function(r){switch(r.label){case 0:return n=void 0===this.storageHandler?c:this.storageHandler,o=i+"-"+t,null===(a=n.getItemSync(o))?[2]:(s=JSON.parse(a)).id!==this.id?[3,2]:[4,f.default().lock(s.iat)];case 1:r.sent(),this.acquiredIatSet.delete(s.iat),n.removeItemSync(o),f.default().unlock(s.iat),e.notifyWaiters(),r.label=2;case 2:return[2]}})})},e.lockCorrector=function(t){for(var n=Date.now()-5e3,r=t,o=[],c=0;;){var a=r.keySync(c);if(null===a)break;o.push(a),c++}for(var s=!1,u=0;u<o.length;u++){var l=o[u];if(l.includes(i)){var f=r.getItemSync(l);if(null!==f){var d=JSON.parse(f);(void 0===d.timeRefreshed&&d.timeAcquired<n||void 0!==d.timeRefreshed&&d.timeRefreshed<n)&&(r.removeItemSync(l),s=!0)}}}s&&e.notifyWaiters()},e.waiters=void 0,e}();t.default=d}));Error;new TextEncoder,new TextDecoder;let h;if(Uint8Array.prototype.toBase64)h=e=>(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e.toBase64({alphabet:"base64url",omitPadding:!0}));else{const e=32768;h=t=>{t instanceof ArrayBuffer&&(t=new Uint8Array(t));const n=[];for(let r=0;r<t.byteLength;r+=e)n.push(String.fromCharCode.apply(null,t.subarray(r,r+e)));return btoa(n.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}}Error;Error;var v=l(function(e,t){var n=s&&s.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};function r(e,t){if(!t)return"";var n="; "+e;return!0===t?n:n+"="+t}function o(e,t,n){return encodeURIComponent(e).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(t).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(e){if("number"==typeof e.expires){var t=new Date;t.setMilliseconds(t.getMilliseconds()+864e5*e.expires),e.expires=t}return r("Expires",e.expires?e.expires.toUTCString():"")+r("Domain",e.domain)+r("Path",e.path)+r("Secure",e.secure)+r("SameSite",e.sameSite)}(n)}function i(e){for(var t={},n=e?e.split("; "):[],r=/(%[\dA-F]{2})+/gi,o=0;o<n.length;o++){var i=n[o].split("="),c=i.slice(1).join("=");'"'===c.charAt(0)&&(c=c.slice(1,-1));try{t[i[0].replace(r,decodeURIComponent)]=c.replace(r,decodeURIComponent)}catch(e){}}return t}function c(){return i(document.cookie)}function a(e,t,r){document.cookie=o(e,t,n({path:"/"},r))}t.__esModule=!0,t.encode=o,t.parse=i,t.getAll=c,t.get=function(e){return c()[e]},t.set=a,t.remove=function(e,t){a(e,"",n(n({},t),{expires:-1}))}});u(v),v.encode,v.parse,v.getAll;v.get,v.set,v.remove;var p;!function(e){e.Code="code",e.ConnectCode="connect_code"}(p||(p={}));var m;Error;new d;var g,y,w;!function(e){e.STAFF="STAFF",e.ADMIN="ADMIN",e.STANDARD="STANDARD"}(g||(g={})),function(e){e.TRIAL="TRIAL"}(y||(y={})),function(e){e.IN_TRIAL="In Trial",e.CANCELLING="Cancelling",e.LEGACY="Legacy",e.COMPLIMENTARY="Complimentary",e.TRIAL_EXPIRED="Trial Expired",e.NONE=""}(w||(w={}));var b=function(){var e,t,n=null!==(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.partitionKey)&&void 0!==t?t:"default",r="".concat(n,"-auth-token");return localStorage.getItem(r)};n(64583).Promise;function _(e,t){var n=c.replace(/\/$/,""),r="dev"===i,a="/dialogs/".concat(e),s=r?a:"/".concat(o).concat(a),u=t?"?action=".concat(t):"";return"".concat(n).concat(s).concat(u)}var S=function(e){var t,n;(null===(n=null===(t=Office.context)||void 0===t?void 0:t.ui)||void 0===n?void 0:n.openBrowserWindow)?Office.context.ui.openBrowserWindow(e):window.open(e,"_blank")},k=n(64583).Promise,O=function(e,t,n,r){return new(n||(n=k))(function(o,i){function c(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((r=r.apply(e,t||[])).next())})},A=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},c=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return c.next=a(0),c.throw=a(1),c.return=a(2),"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};function I(e){e.completed()}function T(e){return O(this,void 0,void 0,function(){var t,n,r=this;return A(this,function(o){return t=_("auth.html","logout"),Office&&(null===(n=Office.context)||void 0===n?void 0:n.ui)?b()?(Office.context.ui.displayDialogAsync(t,{height:60,width:40,displayInIframe:!1,promptBeforeOpen:!1},function(t){if(t.status===Office.AsyncResultStatus.Failed)console.error("Failed to open logout dialog.");else{var n=t.value;n.addEventHandler(Office.EventType.DialogMessageReceived,function(e){return O(r,void 0,void 0,function(){var t,r;return A(this,function(o){return t=JSON.parse(e.message),function(){var e,t=null!==(e=Office.context.partitionKey)&&void 0!==e?e:"default";localStorage.removeItem("".concat(t,"-user-data")),localStorage.removeItem("".concat(t,"-auth-token")),Object.keys(localStorage).forEach(function(e){(e.startsWith("ld:")||e.startsWith("@@auth0spajs@@"))&&localStorage.removeItem(e)})}(),"logout-success"===t.type&&((r=new BroadcastChannel("grata-auth-channel")).postMessage({type:"auth-changed",action:"logout",timestamp:Date.now()}),r.close(),n.close()),[2]})})})}e.completed()}),e.completed(),[2]):(e.completed(),[2]):(console.error("Office context not available"),e.completed(),[2])})})}function x(e){return O(this,void 0,void 0,function(){var t,n,r=this;return A(this,function(o){return t=_("auth.html","login"),Office&&(null===(n=Office.context)||void 0===n?void 0:n.ui)?b()?(e.completed(),[2]):(Office.context.ui.displayDialogAsync(t,{height:60,width:40,displayInIframe:!1,promptBeforeOpen:!1},function(t){if(t.status===Office.AsyncResultStatus.Failed)return console.error("Failed to open login dialog."),void e.completed();var n=t.value;n.addEventHandler(Office.EventType.DialogMessageReceived,function(t){return O(r,void 0,void 0,function(){var r,o,i;return A(this,function(c){switch(c.label){case 0:return c.trys.push([0,4,,5]),"auth-success"!==(r=JSON.parse(t.message)).type?[3,2]:(function(e){var t,n,r=null!==(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.partitionKey)&&void 0!==n?n:"default";localStorage.setItem("".concat(r,"-auth-token"),e)}(r.token),[4,new k(function(e){return setTimeout(e,200)})]);case 1:return c.sent(),(o=new BroadcastChannel("grata-auth-channel")).postMessage({type:"auth-changed",action:"login",timestamp:Date.now()}),o.close(),n.close(),e.completed(),[3,3];case 2:"auth-error"===r.type&&(console.error(r.error),e.completed()),c.label=3;case 3:return[3,5];case 4:return i=c.sent(),console.error("Invalid message received from dialog.",i),e.completed(),[3,5];case 5:return[2]}})})})}),e.completed(),[2]):(console.error("Office context not available"),e.completed(),[2])})})}function E(e){return O(this,void 0,void 0,function(){return A(this,function(t){return S("https://help.grata.com"),e.completed(),[2]})})}function C(e){return O(this,void 0,void 0,function(){return A(this,function(t){return S("https://search-beta.grata.com"),e.completed(),[2]})})}function L(e){return O(this,void 0,void 0,function(){return A(this,function(t){switch(t.label){case 0:return[4,OfficeRuntime.storage.setItem("open-route","/credits")];case 1:return t.sent(),[4,Office.addin.showAsTaskpane()];case 2:return t.sent(),e.completed(),[2]}})})}function D(e){return O(this,void 0,void 0,function(){return A(this,function(t){switch(t.label){case 0:return[4,OfficeRuntime.storage.setItem("open-route","/home")];case 1:return t.sent(),[4,Office.addin.showAsTaskpane()];case 2:return t.sent(),e.completed(),[2]}})})}Office.onReady(function(){return O(void 0,void 0,void 0,function(){return A(this,function(e){return Office.actions.associate("command",I),Office.actions.associate("onLogoutButtonClick",T),Office.actions.associate("onLoginButtonClick",x),Office.actions.associate("openHelp",E),Office.actions.associate("openGrata",C),Office.actions.associate("showCredits",L),Office.actions.associate("showFormulaBuilder",D),[2]})})}).then(function(){return console.info("Grata Excel Add-in commands on version ".concat(o," loaded."))})}()}();